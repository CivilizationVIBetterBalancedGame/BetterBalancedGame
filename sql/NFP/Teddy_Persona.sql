--==================
-- America
--==================

-- Teddy-BM get vietnam ability to plant wood (have to recreate modifier to not be dependent on kublai-vietnam dlc)
INSERT INTO Modifiers(ModifierId, ModifierType) VALUES
  ('TEDDY_PLANT_MEDIEVAL_WOODS_BBG', 'MODIFIER_PLAYER_ADJUST_FEATURE_UNLOCK');
INSERT INTO ModifierArguments(ModifierId, Name, Value) VALUES
  ('TEDDY_PLANT_MEDIEVAL_WOODS_BBG', 'FeatureType', 'FEATURE_FOREST'),
  ('TEDDY_PLANT_MEDIEVAL_WOODS_BBG', 'CivicType', 'CIVIC_MEDIEVAL_FAIRES');
INSERT INTO TraitModifiers(TraitType, ModifierId) VALUES
  ('TRAIT_LEADER_ANTIQUES_AND_PARKS', 'TEDDY_PLANT_MEDIEVAL_WOODS_BBG');

-- Codenaugh's BM modification
UPDATE ModifierArguments SET Value='1' WHERE ModifierId='TRAIT_ANTIQUES_AND_PARKS_CULTURE_FORESTS_OR_WONDERS' AND Name='Amount';
UPDATE ModifierArguments SET Value='1' WHERE ModifierId='TRAIT_ANTIQUES_AND_PARKS_SCIENCE_NATIONAL_WONDERS_OR_MOUNTAINS' AND Name='Amount';

INSERT OR IGNORE INTO TraitModifiers VALUES ('TRAIT_LEADER_ANTIQUES_AND_PARKS', 'TRAIT_ANTIQUES_AND_PARKS_CULTURE_FORESTS_OR_WONDERS_BBG');
INSERT OR IGNORE INTO TraitModifiers VALUES ('TRAIT_LEADER_ANTIQUES_AND_PARKS', 'TRAIT_ANTIQUES_AND_PARKS_SCIENCE_NATIONAL_WONDERS_OR_MOUNTAINS_BBG');
INSERT OR IGNORE INTO Modifiers (ModifierId, ModifierType, SubjectRequirementSetId) VALUES
  ('TRAIT_ANTIQUES_AND_PARKS_CULTURE_FORESTS_OR_WONDERS_BBG', 'MODIFIER_PLAYER_ADJUST_PLOT_YIELD', 'REQUIREMENTS_PLOT_ADJACENT_FORESTS_OR_WONDERS_BREATHTAKING_BBG'),
  ('TRAIT_ANTIQUES_AND_PARKS_SCIENCE_NATIONAL_WONDERS_OR_MOUNTAINS_BBG', 'MODIFIER_PLAYER_ADJUST_PLOT_YIELD', 'REQUIREMENTS_PLOT_ADJACENT_NATURAL_WONDERS_OR_MOUNTAINS_BREATHTAKING_BBG');
INSERT OR IGNORE INTO ModifierArguments (ModifierId, Name, Value) VALUES
  ('TRAIT_ANTIQUES_AND_PARKS_CULTURE_FORESTS_OR_WONDERS_BBG', 'YieldType' , 'YIELD_CULTURE'),
  ('TRAIT_ANTIQUES_AND_PARKS_CULTURE_FORESTS_OR_WONDERS_BBG', 'Amount' , '1'),
  ('TRAIT_ANTIQUES_AND_PARKS_SCIENCE_NATIONAL_WONDERS_OR_MOUNTAINS_BBG', 'YieldType' , 'YIELD_SCIENCE'),
  ('TRAIT_ANTIQUES_AND_PARKS_SCIENCE_NATIONAL_WONDERS_OR_MOUNTAINS_BBG', 'Amount' , '1');
INSERT OR IGNORE INTO RequirementSets VALUES
  ('REQUIREMENTS_PLOT_ADJACENT_FORESTS_OR_WONDERS_BREATHTAKING_BBG', 'REQUIREMENTSET_TEST_ALL'),
  ('REQUIREMENTS_PLOT_ADJACENT_NATURAL_WONDERS_OR_MOUNTAINS_BREATHTAKING_BBG', 'REQUIREMENTSET_TEST_ALL');
INSERT OR IGNORE INTO RequirementSetRequirements VALUES
  ('REQUIREMENTS_PLOT_ADJACENT_FORESTS_OR_WONDERS_BREATHTAKING_BBG', 'PLOT_ADJACENT_FORESTS_OR_WONDERS_REQUIREMENTS_MET'),
  ('REQUIREMENTS_PLOT_ADJACENT_FORESTS_OR_WONDERS_BREATHTAKING_BBG', 'REQUIRES_PLOT_BREATHTAKING_APPEAL_ROOSEVELT'),
  ('REQUIREMENTS_PLOT_ADJACENT_FORESTS_OR_WONDERS_BREATHTAKING_BBG', 'REQUIRES_PLAYER_HAS_THE_ENLIGHTENMENT_BBG'),
  ('REQUIREMENTS_PLOT_ADJACENT_NATURAL_WONDERS_OR_MOUNTAINS_BREATHTAKING_BBG', 'PLOT_ADJACENT_NATURAL_WONDERS_OR_MOUNTAINS_MET'),
  ('REQUIREMENTS_PLOT_ADJACENT_NATURAL_WONDERS_OR_MOUNTAINS_BREATHTAKING_BBG', 'REQUIRES_PLOT_BREATHTAKING_APPEAL_ROOSEVELT'),
  ('REQUIREMENTS_PLOT_ADJACENT_NATURAL_WONDERS_OR_MOUNTAINS_BREATHTAKING_BBG', 'REQUIRES_PLAYER_HAS_ASTRONOMY_BBG');
INSERT INTO Requirements (RequirementId, RequirementType) VALUES
  ('REQUIRES_PLAYER_HAS_THE_ENLIGHTENMENT_BBG', 'REQUIREMENT_PLAYER_HAS_CIVIC'),
  ('REQUIRES_PLAYER_HAS_ASTRONOMY_BBG', 'REQUIREMENT_PLAYER_HAS_TECHNOLOGY');
INSERT INTO RequirementArguments (RequirementId, Name, Value) VALUES
  ('REQUIRES_PLAYER_HAS_THE_ENLIGHTENMENT_BBG', 'CivicType', 'CIVIC_THE_ENLIGHTENMENT'),
  ('REQUIRES_PLAYER_HAS_ASTRONOMY_BBG', 'TechnologyType', 'TECH_ASTRONOMY');

-- Teddy RR combat strength change with era
INSERT INTO RequirementSets(RequirementSetId, RequirementSetType) VALUES
  ('BBG_TEDDY_IS_IN_ANCIENT', 'REQUIREMENTSET_TEST_ALL'),
  ('BBG_TEDDY_IS_IN_CLASSICAL', 'REQUIREMENTSET_TEST_ALL'),
  ('BBG_TEDDY_IS_IN_MEDIEVAL', 'REQUIREMENTSET_TEST_ALL'),
  ('BBG_TEDDY_IS_IN_RENAISSANCE', 'REQUIREMENTSET_TEST_ALL'),
  ('BBG_TEDDY_IS_IN_INDUSTRIAL', 'REQUIREMENTSET_TEST_ALL');

INSERT INTO RequirementSetRequirements(RequirementSetId, RequirementId) VALUES
  ('BBG_TEDDY_IS_IN_ANCIENT', 'BBG_PLAYER_IS_IN_ERA_ANCIENT_REQUIREMENT'),
  ('BBG_TEDDY_IS_IN_ANCIENT', 'BBG_PLAYER_IS_NOT_IN_ERA_CLASSICAL_REQUIREMENT'),

  ('BBG_TEDDY_IS_IN_CLASSICAL', 'BBG_PLAYER_IS_IN_ERA_CLASSICAL_REQUIREMENT'),
  ('BBG_TEDDY_IS_IN_CLASSICAL', 'BBG_PLAYER_IS_NOT_IN_ERA_MEDIEVAL_REQUIREMENT'),

  ('BBG_TEDDY_IS_IN_MEDIEVAL', 'BBG_PLAYER_IS_IN_ERA_MEDIEVAL_REQUIREMENT'),
  ('BBG_TEDDY_IS_IN_MEDIEVAL', 'BBG_PLAYER_IS_NOT_IN_ERA_RENAISSANCE_REQUIREMENT'),

  ('BBG_TEDDY_IS_IN_RENAISSANCE', 'BBG_PLAYER_IS_IN_ERA_RENAISSANCE_REQUIREMENT'),
  ('BBG_TEDDY_IS_IN_RENAISSANCE', 'BBG_PLAYER_IS_NOT_IN_ERA_INDUSTRIAL_REQUIREMENT'),

  ('BBG_TEDDY_IS_IN_INDUSTRIAL', 'BBG_PLAYER_IS_IN_ERA_INDUSTRIAL_REQUIREMENT');

INSERT INTO Modifiers(ModifierId, ModifierType) VALUES
  ('BBG_TEDDY_COMBAT_BONUS_IN_ERA_ANCIENT', 'MODIFIER_UNIT_ADJUST_COMBAT_STRENGTH'),
  ('BBG_TEDDY_COMBAT_BONUS_IN_ERA_CLASSICAL', 'MODIFIER_UNIT_ADJUST_COMBAT_STRENGTH'),
  ('BBG_TEDDY_COMBAT_BONUS_IN_ERA_MEDIEVAL', 'MODIFIER_UNIT_ADJUST_COMBAT_STRENGTH'),
  ('BBG_TEDDY_COMBAT_BONUS_IN_ERA_RENAISSANCE', 'MODIFIER_UNIT_ADJUST_COMBAT_STRENGTH'),
  ('BBG_TEDDY_COMBAT_BONUS_IN_ERA_INDUSTRIAL', 'MODIFIER_UNIT_ADJUST_COMBAT_STRENGTH');

INSERT INTO ModifierArguments (ModifierId, Name, Value) VALUES
  ('BBG_TEDDY_COMBAT_BONUS_IN_ERA_ANCIENT', 'Amount', 1),
  ('BBG_TEDDY_COMBAT_BONUS_IN_ERA_CLASSICAL', 'Amount', 2),
  ('BBG_TEDDY_COMBAT_BONUS_IN_ERA_MEDIEVAL', 'Amount', 3),
  ('BBG_TEDDY_COMBAT_BONUS_IN_ERA_RENAISSANCE', 'Amount', 4),
  ('BBG_TEDDY_COMBAT_BONUS_IN_ERA_INDUSTRIAL', 'Amount', 5);

INSERT INTO ModifierStrings (ModifierId, Context, Text) VALUES
 ('BBG_TEDDY_COMBAT_BONUS_IN_ERA_ANCIENT', 'Preview', 'LOC_BBG_TEDDY_COMBAT_BONUS_IN_ANCIENT'),
 ('BBG_TEDDY_COMBAT_BONUS_IN_ERA_CLASSICAL', 'Preview', 'LOC_BBG_TEDDY_COMBAT_BONUS_IN_CLASSICAL'),
 ('BBG_TEDDY_COMBAT_BONUS_IN_ERA_MEDIEVAL', 'Preview', 'LOC_BBG_TEDDY_COMBAT_BONUS_IN_MEDIEVAL'),
 ('BBG_TEDDY_COMBAT_BONUS_IN_ERA_RENAISSANCE', 'Preview', 'LOC_BBG_TEDDY_COMBAT_BONUS_IN_RENAISSANCE'),
 ('BBG_TEDDY_COMBAT_BONUS_IN_ERA_INDUSTRIAL', 'Preview', 'LOC_BBG_TEDDY_COMBAT_BONUS_IN_INDUSTRIAL');

INSERT INTO Modifiers(ModifierId, ModifierType, SubjectRequirementSetId) VALUES
  ('BBG_GIVE_MODIFIER_TEDDY_COMBAT_BONUS_IN_ERA_ANCIENT', 'MODIFIER_PLAYER_UNITS_GRANT_ABILITY', 'BBG_TEDDY_IS_IN_ANCIENT'),
  ('BBG_GIVE_MODIFIER_TEDDY_COMBAT_BONUS_IN_ERA_CLASSICAL', 'MODIFIER_PLAYER_UNITS_GRANT_ABILITY', 'BBG_TEDDY_IS_IN_CLASSICAL'),
  ('BBG_GIVE_MODIFIER_TEDDY_COMBAT_BONUS_IN_ERA_MEDIEVAL', 'MODIFIER_PLAYER_UNITS_GRANT_ABILITY', 'BBG_TEDDY_IS_IN_MEDIEVAL'),
  ('BBG_GIVE_MODIFIER_TEDDY_COMBAT_BONUS_IN_ERA_RENAISSANCE', 'MODIFIER_PLAYER_UNITS_GRANT_ABILITY', 'BBG_TEDDY_IS_IN_RENAISSANCE'),
  ('BBG_GIVE_MODIFIER_TEDDY_COMBAT_BONUS_IN_ERA_INDUSTRIAL', 'MODIFIER_PLAYER_UNITS_GRANT_ABILITY', 'BBG_TEDDY_IS_IN_INDUSTRIAL');

INSERT INTO ModifierArguments (ModifierId, Name, Value) VALUES
  ('BBG_GIVE_MODIFIER_TEDDY_COMBAT_BONUS_IN_ERA_ANCIENT', 'AbilityType', 'BBG_TEDDY_RR_COMBAT_ABILITY_ANCIENT'),
  ('BBG_GIVE_MODIFIER_TEDDY_COMBAT_BONUS_IN_ERA_CLASSICAL', 'AbilityType', 'BBG_TEDDY_RR_COMBAT_ABILITY_CLASSICAL'),
  ('BBG_GIVE_MODIFIER_TEDDY_COMBAT_BONUS_IN_ERA_MEDIEVAL', 'AbilityType', 'BBG_TEDDY_RR_COMBAT_ABILITY_MEDIEVAL'),
  ('BBG_GIVE_MODIFIER_TEDDY_COMBAT_BONUS_IN_ERA_RENAISSANCE', 'AbilityType', 'BBG_TEDDY_RR_COMBAT_ABILITY_RENAISSANCE'),
  ('BBG_GIVE_MODIFIER_TEDDY_COMBAT_BONUS_IN_ERA_INDUSTRIAL', 'AbilityType', 'BBG_TEDDY_RR_COMBAT_ABILITY_INDUSTRIAL');

-- Create Unit Ability
INSERT INTO Types(Type, Kind) VALUES
    ('BBG_TEDDY_RR_COMBAT_ABILITY_ANCIENT', 'KIND_ABILITY'),
    ('BBG_TEDDY_RR_COMBAT_ABILITY_CLASSICAL', 'KIND_ABILITY'),
    ('BBG_TEDDY_RR_COMBAT_ABILITY_MEDIEVAL', 'KIND_ABILITY'),
    ('BBG_TEDDY_RR_COMBAT_ABILITY_RENAISSANCE', 'KIND_ABILITY'),
    ('BBG_TEDDY_RR_COMBAT_ABILITY_INDUSTRIAL', 'KIND_ABILITY');

INSERT INTO TypeTags(Type, Tag) VALUES
    ('BBG_TEDDY_RR_COMBAT_ABILITY_ANCIENT', 'CLASS_ALL_COMBAT_UNITS'),
    ('BBG_TEDDY_RR_COMBAT_ABILITY_CLASSICAL', 'CLASS_ALL_COMBAT_UNITS'),
    ('BBG_TEDDY_RR_COMBAT_ABILITY_MEDIEVAL', 'CLASS_ALL_COMBAT_UNITS'),
    ('BBG_TEDDY_RR_COMBAT_ABILITY_RENAISSANCE', 'CLASS_ALL_COMBAT_UNITS'),
    ('BBG_TEDDY_RR_COMBAT_ABILITY_INDUSTRIAL', 'CLASS_ALL_COMBAT_UNITS');

INSERT INTO UnitAbilities(UnitAbilityType , Name, Description, Inactive) VALUES
    ('BBG_TEDDY_RR_COMBAT_ABILITY_ANCIENT', 'LOC_BBG_TEDDY_COMBAT_BONUS_IN_ANCIENT', 'LOC_BBG_TEDDY_COMBAT_BONUS_IN_ANCIENT', 1),
    ('BBG_TEDDY_RR_COMBAT_ABILITY_CLASSICAL', 'LOC_BBG_TEDDY_COMBAT_BONUS_IN_CLASSICAL', 'LOC_BBG_TEDDY_COMBAT_BONUS_IN_CLASSICAL', 1),
    ('BBG_TEDDY_RR_COMBAT_ABILITY_MEDIEVAL', 'LOC_BBG_TEDDY_COMBAT_BONUS_IN_MEDIEVAL', 'LOC_BBG_TEDDY_COMBAT_BONUS_IN_MEDIEVAL', 1),
    ('BBG_TEDDY_RR_COMBAT_ABILITY_RENAISSANCE', 'LOC_BBG_TEDDY_COMBAT_BONUS_IN_RENAISSANCE', 'LOC_BBG_TEDDY_COMBAT_BONUS_IN_RENAISSANCE', 1),
    ('BBG_TEDDY_RR_COMBAT_ABILITY_INDUSTRIAL', 'LOC_BBG_TEDDY_COMBAT_BONUS_IN_INDUSTRIAL', 'LOC_BBG_TEDDY_COMBAT_BONUS_IN_INDUSTRIAL', 1);

INSERT INTO UnitAbilityModifiers(UnitAbilityType, ModifierId) VALUES
    ('BBG_TEDDY_RR_COMBAT_ABILITY_ANCIENT', 'BBG_TEDDY_COMBAT_BONUS_IN_ERA_ANCIENT'),
    ('BBG_TEDDY_RR_COMBAT_ABILITY_CLASSICAL', 'BBG_TEDDY_COMBAT_BONUS_IN_ERA_CLASSICAL'),
    ('BBG_TEDDY_RR_COMBAT_ABILITY_MEDIEVAL', 'BBG_TEDDY_COMBAT_BONUS_IN_ERA_MEDIEVAL'),
    ('BBG_TEDDY_RR_COMBAT_ABILITY_RENAISSANCE', 'BBG_TEDDY_COMBAT_BONUS_IN_ERA_RENAISSANCE'),
    ('BBG_TEDDY_RR_COMBAT_ABILITY_INDUSTRIAL', 'BBG_TEDDY_COMBAT_BONUS_IN_ERA_INDUSTRIAL');

 INSERT INTO TraitModifiers(TraitType, ModifierId)
    SELECT 'TRAIT_LEADER_ROOSEVELT_COROLLARY', 'BBG_GIVE_MODIFIER_TEDDY_COMBAT_BONUS_IN_' || EraType
    FROM Eras
    WHERE EraType in ('ERA_ANCIENT', 'ERA_CLASSICAL', 'ERA_MEDIEVAL', 'ERA_RENAISSANCE', 'ERA_INDUSTRIAL');

-- Delete existing RR +5 on home continent 
DELETE FROM TypeTags where Type = 'ABILITY_ROOSEVELT_COMBAT_BONUS_HOME_CONTINENT';
DELETE FROM TraitModifiers WHERE TraitType='TRAIT_LEADER_ROOSEVELT_COROLLARY' AND ModifierId='TRAIT_COMBAT_BONUS_HOME_CONTINENT';

-- INSERT OR IGNORE INTO Requirements (RequirementId, RequirementType)
--   SELECT 'BBG_REQUIRES_PLAYER_HAS_' || t.TechnologyType, 'REQUIREMENT_PLAYER_HAS_TECHNOLOGY'
--   FROM Eras e
--   left join Technologies t on e.EraType = t.EraType 
--   WHERE e.EraType in ('ERA_ANCIENT', 'ERA_CLASSICAL', 'ERA_MEDIEVAL', 'ERA_RENAISSANCE', 'ERA_INDUSTRIAL');
-- INSERT OR IGNORE INTO RequirementArguments
--   SELECT 'BBG_REQUIRES_PLAYER_HAS_' || t.TechnologyType, 'TechnologyType', 'ARGTYPE_IDENTITY', t.TechnologyType, null, null
--   FROM Eras e
--   left join Technologies t on e.EraType = t.EraType 
--   WHERE e.EraType in ('ERA_ANCIENT', 'ERA_CLASSICAL', 'ERA_MEDIEVAL', 'ERA_RENAISSANCE', 'ERA_INDUSTRIAL');
-- INSERT OR IGNORE INTO RequirementSets(RequirementSetId, RequirementSetType)
--   SELECT 'BBG_PLAYER_' || EraType || '_REQUIREMENTS', 'REQUIREMENTSET_TEST_ANY'
--   FROM Eras e
--   WHERE e.EraType in ('ERA_ANCIENT', 'ERA_CLASSICAL', 'ERA_MEDIEVAL', 'ERA_RENAISSANCE', 'ERA_INDUSTRIAL');
-- INSERT OR IGNORE INTO RequirementSetRequirements(RequirementSetId, RequirementId)
--   SELECT rs.RequirementSetId, r.RequirementId 
--   FROM Eras e
--   left join Technologies t on e.EraType = t.EraType
--   left join RequirementArguments ra on ra.value = t.TechnologyType 
--   left join Requirements r on r.RequirementId = ra.RequirementId 
--   left join RequirementSets rs on rs.RequirementSetId = 'BBG_PLAYER_' || e.EraType || '_REQUIREMENTS'
--   WHERE e.EraType in ('ERA_ANCIENT', 'ERA_CLASSICAL', 'ERA_MEDIEVAL', 'ERA_RENAISSANCE', 'ERA_INDUSTRIAL');

-- INSERT OR IGNORE INTO Modifiers(ModifierId, ModifierType, OwnerRequirementSetId, RunOnce, Permanent)
--   SELECT 'TRAIT_COMBAT_BONUS_ON_' || e.EraType, 'MODIFIER_PLAYER_UNITS_ADJUST_COMBAT_STRENGTH', rs.RequirementSetId, 0, 0
--   FROM Eras e
--   left join RequirementSets rs on rs.RequirementSetId = 'BBG_PLAYER_' || e.EraType || '_REQUIREMENTS'
--   WHERE e.EraType in ('ERA_ANCIENT', 'ERA_CLASSICAL', 'ERA_MEDIEVAL', 'ERA_RENAISSANCE', 'ERA_INDUSTRIAL');
-- INSERT OR IGNORE INTO ModifierArguments (ModifierId, Name, Value)
--   SELECT 'TRAIT_COMBAT_BONUS_ON_' || EraType, 'Amount', 1
--   FROM Eras 
--   WHERE EraType in ('ERA_ANCIENT', 'ERA_CLASSICAL', 'ERA_MEDIEVAL', 'ERA_RENAISSANCE', 'ERA_INDUSTRIAL');
  
-- INSERT OR IGNORE INTO TraitModifiers(TraitType, ModifierId)
--   SELECT 'TRAIT_LEADER_ROOSEVELT_COROLLARY', 'TRAIT_COMBAT_BONUS_ON_' || EraType
--   FROM Eras
--   WHERE EraType in ('ERA_ANCIENT', 'ERA_CLASSICAL', 'ERA_MEDIEVAL', 'ERA_RENAISSANCE', 'ERA_INDUSTRIAL');

-- DELETE FROM TraitModifiers WHERE TraitType='TRAIT_LEADER_ROOSEVELT_COROLLARY' AND ModifierId='TRAIT_COMBAT_BONUS_HOME_CONTINENT';
