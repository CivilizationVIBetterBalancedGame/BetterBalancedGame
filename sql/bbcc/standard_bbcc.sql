INSERT INTO Requirements(RequirementId, RequirementType, Inverse) VALUES
	('REQ_PLOT_HAS_NO_GEOTHERMAL_BBCC', 'REQUIREMENT_PLOT_FEATURE_TYPE_MATCHES', '1'),
    ('REQ_PLOT_HAS_NO_CLIFFS_OF_DOVER_BBCC', 'REQUIREMENT_PLOT_FEATURE_TYPE_MATCHES', '1'),
    ('REQ_NO_NAT_DISASTER_BBCC', 'REQUIREMENT_PLOT_PROPERTY_MATCHES','1'),
    ('REQ_NO_WONDER_YIELDS_BBCC', 'REQUIREMENT_PLOT_PROPERTY_MATCHES','1');

INSERT INTO RequirementArguments(RequirementId, Name, Value) VALUES
	('REQ_NO_NAT_DISASTER_BBCC', 'PropertyName', 'HAD_NAT_DISASTER_BBCC'),
	('REQ_NO_NAT_DISASTER_BBCC', 'PropertyMinimum', '1'),
	('REQ_NO_WONDER_YIELDS_BBCC', 'PropertyName', 'ADJACENT_TO_YIELD_WONDER_BBCC'),
	('REQ_NO_WONDER_YIELDS_BBCC', 'PropertyMinimum', '1');

CREATE TABLE BBCC_SettleFeature AS
SELECT Features.FeatureType, Feature_ValidTerrains.TerrainType
FROM Features INNER JOIN Feature_ValidTerrains
ON Features.FeatureType = Feature_ValidTerrains.FeatureType
WHERE Feature_ValidTerrains.TerrainType IN ('TERRAIN_GRASS', 'TERRAIN_GRASS_HILLS', 'TERRAIN_PLAINS', 'TERRAIN_PLAINS_HILLS', 'TERRAIN_DESERT', 'TERRAIN_DESERT_HILLS', 'TERRAIN_TUNDRA', 'TERRAIN_TUNDRA_HILLS', 'TERRAIN_SNOW', 'TERRAIN_SNOW_HILLS')
	AND Features.Removable = 0 
	AND Features.Settlement = 1 
	AND Features.FeatureType NOT LIKE '%FLOODPLAINS%';

INSERT OR IGNORE INTO Requirements(RequirementId, RequirementType, Inverse)
	SELECT 'REQ_PLOT_HAS_NO_'||BBCC_SettleFeature.FeatureType||'_BBCC', 'REQUIREMENT_PLOT_FEATURE_TYPE_MATCHES', '1'
	FROM BBCC_SettleFeature;

INSERT OR IGNORE INTO RequirementArguments(RequirementId, Name, Value)
	SELECT 'REQ_PLOT_HAS_NO_'||BBCC_SettleFeature.FeatureType||'_BBCC', 'FeatureType', BBCC_SettleFeature.FeatureType
	FROM BBCC_SettleFeature;

INSERT INTO RequirementSets(RequirementSetId, RequirementSetType) VALUES
	('REQSET_PLOT_IS_GRASSLAND_CITY_BBCC', 'REQUIREMENTSET_TEST_ALL'),
	('REQSET_PLOT_IS_GRASSLAND_HILLS_CITY_BBCC', 'REQUIREMENTSET_TEST_ALL'),
	('REQSET_PLOT_IS_PLAINS_CITY_BBCC', 'REQUIREMENTSET_TEST_ALL');

INSERT INTO RequirementSetRequirements(RequirementSetId, RequirementId) VALUES
	('REQSET_PLOT_IS_GRASSLAND_CITY_BBCC', 'REQ_PLOT_IS_CITY_CENTER_BBCC'),
	('REQSET_PLOT_IS_GRASSLAND_CITY_BBCC', 'REQ_PLOT_HAS_GRASS_BBCC'),
	('REQSET_PLOT_IS_GRASSLAND_CITY_BBCC', 'REQ_NO_NAT_DISASTER_BBCC'),
	('REQSET_PLOT_IS_GRASSLAND_CITY_BBCC', 'REQ_NO_WONDER_YIELDS_BBCC');

INSERT OR IGNORE INTO RequirementSetRequirements(RequirementSetId, RequirementId)
	SELECT 'REQSET_PLOT_IS_GRASSLAND_CITY_BBCC', 'REQ_HAS_NO_'||BBCCRes.ResourceType||'_BBCC'
	FROM BBCCRes WHERE ResourceClassType<>'RESOURCECLASS_STRATEGIC' AND TerrainType='TERRAIN_GRASS';

INSERT OR IGNORE INTO RequirementSetRequirements(RequirementSetId, RequirementId)
	SELECT 'REQSET_PLOT_IS_GRASSLAND_CITY_BBCC', 'REQ_HAS_NO_OR_SEES_NO_'||BBCCRes.ResourceType||'_BBCC'
	FROM BBCCRes WHERE ResourceClassType='RESOURCECLASS_STRATEGIC' AND TerrainType='TERRAIN_GRASS';

INSERT INTO RequirementSetRequirements(RequirementSetId, RequirementId)
	SELECT 'REQSET_PLOT_IS_GRASSLAND_CITY_BBCC', 'REQ_PLOT_HAS_NO_'||BBCC_SettleFeature.FeatureType||'_BBCC'
	FROM BBCC_SettleFeature WHERE TerrainType LIKE '%GRASSLAND%';

INSERT INTO RequirementSetRequirements(RequirementSetId, RequirementId) VALUES
	('REQSET_PLOT_IS_GRASSLAND_HILLS_CITY_BBCC', 'REQ_PLOT_IS_CITY_CENTER_BBCC'),
	('REQSET_PLOT_IS_GRASSLAND_HILLS_CITY_BBCC', 'PLOT_IS_GRASS_HILLS_TERRAIN_REQUIREMENT'),
	('REQSET_PLOT_IS_GRASSLAND_HILLS_CITY_BBCC', 'REQ_NO_NAT_DISASTER_BBCC'),
	('REQSET_PLOT_IS_GRASSLAND_HILLS_CITY_BBCC', 'REQ_NO_WONDER_YIELDS_BBCC');

INSERT OR IGNORE INTO RequirementSetRequirements(RequirementSetId, RequirementId)
	SELECT 'REQSET_PLOT_IS_GRASSLAND_HILLS_CITY_BBCC', 'REQ_HAS_NO_'||BBCCRes.ResourceType||'_BBCC'
	FROM BBCCRes WHERE ResourceClassType<>'RESOURCECLASS_STRATEGIC' AND TerrainType='TERRAIN_GRASS_HILLS';

INSERT OR IGNORE INTO RequirementSetRequirements(RequirementSetId, RequirementId)
	SELECT 'REQSET_PLOT_IS_GRASSLAND_HILLS_CITY_BBCC', 'REQ_HAS_NO_OR_SEES_NO_'||BBCCRes.ResourceType||'_BBCC'
	FROM BBCCRes WHERE ResourceClassType='RESOURCECLASS_STRATEGIC' AND TerrainType='TERRAIN_GRASS_HILLS';

INSERT INTO RequirementSetRequirements(RequirementSetId, RequirementId)
	SELECT 'REQSET_PLOT_IS_GRASSLAND_HILLS_CITY_BBCC', 'REQ_PLOT_HAS_NO_'||BBCC_SettleFeature.FeatureType||'_BBCC'
	FROM BBCC_SettleFeature WHERE TerrainType LIKE '%GRASSLAND%';

INSERT INTO RequirementSetRequirements(RequirementSetId, RequirementId) VALUES
	('REQSET_PLOT_IS_PLAINS_CITY_BBCC', 'REQ_PLOT_IS_CITY_CENTER_BBCC'),
	('REQSET_PLOT_IS_PLAINS_CITY_BBCC', 'REQ_PLOT_HAS_PLAINS_BBCC'),
	('REQSET_PLOT_IS_PLAINS_CITY_BBCC', 'REQ_NO_NAT_DISASTER_BBCC'),
	('REQSET_PLOT_IS_PLAINS_CITY_BBCC', 'REQ_NO_WONDER_YIELDS_BBCC');

INSERT OR IGNORE INTO RequirementSetRequirements(RequirementSetId, RequirementId)
	SELECT 'REQSET_PLOT_IS_PLAINS_CITY_BBCC', 'REQ_HAS_NO_'||BBCCRes.ResourceType||'_BBCC'
	FROM BBCCRes WHERE ResourceClassType<>'RESOURCECLASS_STRATEGIC' AND TerrainType='TERRAIN_PLAINS';

INSERT OR IGNORE INTO RequirementSetRequirements(RequirementSetId, RequirementId)
	SELECT 'REQSET_PLOT_IS_PLAINS_CITY_BBCC', 'REQ_HAS_NO_OR_SEES_NO_'||BBCCRes.ResourceType||'_BBCC'
	FROM BBCCRes WHERE ResourceClassType='RESOURCECLASS_STRATEGIC' AND TerrainType='TERRAIN_PLAINS';

INSERT INTO RequirementSetRequirements(RequirementSetId, RequirementId)
	SELECT 'REQSET_PLOT_IS_GRASSLAND_HILLS_CITY_BBCC', 'REQ_PLOT_HAS_NO_'||BBCC_SettleFeature.FeatureType||'_BBCC'
	FROM BBCC_SettleFeature WHERE TerrainType LIKE '%PLAINS%';

INSERT INTO Modifiers(ModifierId, ModifierType, SubjectRequirementSetId) VALUES
    ('BCC_GRASS_CITY_EXTRA_FOOD', 'MODIFIER_PLAYER_ADJUST_PLOT_YIELD', 'REQSET_PLOT_IS_GRASSLAND_CITY_BBCC'),
    ('BCC_GRASS_HILLS_CITY_EXTRA_PRODUCTION', 'MODIFIER_PLAYER_ADJUST_PLOT_YIELD', 'REQSET_PLOT_IS_GRASSLAND_HILLS_CITY_BBCC'),
    ('BCC_PLAINS_CITY_EXTRA_FOOD', 'MODIFIER_PLAYER_ADJUST_PLOT_YIELD', 'REQSET_PLOT_IS_PLAINS_CITY_BBCC');

INSERT INTO ModifierArguments(ModifierId, Name, Value) VALUES
    ('BCC_GRASS_CITY_EXTRA_FOOD', 'YieldType', 'YIELD_FOOD'),
    ('BCC_GRASS_CITY_EXTRA_FOOD', 'Amount', '1'),
    ('BCC_PLAINS_CITY_EXTRA_FOOD', 'YieldType', 'YIELD_FOOD'),
    ('BCC_PLAINS_CITY_EXTRA_FOOD', 'Amount', '1'),
    ('BCC_GRASS_HILLS_CITY_EXTRA_PRODUCTION', 'YieldType', 'YIELD_PRODUCTION'),
    ('BCC_GRASS_HILLS_CITY_EXTRA_PRODUCTION', 'Amount', '1');

INSERT INTO TraitModifiers(TraitType, ModifierId) VALUES
    ('TRAIT_LEADER_MAJOR_CIV', 'BCC_GRASS_CITY_EXTRA_FOOD'),
    ('TRAIT_LEADER_MAJOR_CIV', 'BCC_GRASS_HILLS_CITY_EXTRA_PRODUCTION'),
    ('TRAIT_LEADER_MAJOR_CIV', 'BCC_PLAINS_CITY_EXTRA_FOOD'),
    ('MINOR_CIV_DEFAULT_TRAIT', 'BCC_GRASS_CITY_EXTRA_FOOD'),
    ('MINOR_CIV_DEFAULT_TRAIT', 'BCC_GRASS_HILLS_CITY_EXTRA_PRODUCTION'),
    ('MINOR_CIV_DEFAULT_TRAIT', 'BCC_PLAINS_CITY_EXTRA_FOOD');

DROP TABLE BBCCRes;
DROP TABLE BBCC_SettleFeature;

CREATE TABLE BBCCRes_AdjYieldFeatures(
	FeatureType TEXT NOT NULL,
	FOREIGN KEY (FeatureType) REFERENCES Features(FeatureType) ON DELETE CASCADE ON UPDATE CASCADE,
	PRIMARY KEY (FeatureType)
);

INSERT OR IGNORE INTO BBCCRes_AdjYieldFeatures(FeatureType)
	SELECT Feature_AdjacentYields.FeatureType
	FROM Feature_AdjacentYields;

INSERT INTO BBCCRes_AdjYieldFeatures(FeatureType) VALUES
	('FEATURE_TORRES_DEL_PAINE');